@inject AppState AppState
@inject ApiClient Api

<!--
    Configuring this here is temporary. Later we'll move the app config
    into Program.cs, and it won't be necessary to specify AppAssembly.
-->
<Router AppAssembly=typeof(Program).Assembly />

@functions {
    protected override async Task OnInitAsync()
    {
        Console.WriteLine("App OnInitAsync");

        var token = RegisteredFunction.Invoke<string>("getStoredToken");
        if (token != null)
        {
            Api.SetToken(token);
            AppState.User = await Api.GetUserAsync();
            Console.WriteLine("App updated User");
        }
    }
}
